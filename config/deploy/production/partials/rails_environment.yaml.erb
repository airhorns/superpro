- name: RAILS_ENV
  value: production
- name: REDIS_URL
  value: redis://redis:6379/1
- name: RAILS_SERVE_STATIC_FILES
  value: "true"
- name: RAILS_LOG_TO_STDOUT
  value: "true"
- name: RAILS_LOG_LEVEL
  value: <%= if defined?(rails_log_level) then rails_log_level else "debug" end %>
- name: RELEASE
  value: <%= current_sha %>
- name: DATABASE_URL
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: DATABASE_URL
- name: GOOGLE_CLOUD_PROJECT
  value: superpro-production
- name: ASSETS_GCS_BUCKET
  value: core-assets-gsbxqmgsbxqm.superpro.io
- name: SECRET_KEY_BASE
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: SECRET_KEY_BASE
- name: BACKEND_SENTRY_DSN
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: BACKEND_SENTRY_DSN
- name: FRONTEND_SENTRY_DSN
  value: "https://d4676dd73d8243d88d527f4cf82746e4@sentry.io/1499721"
- name: CUBEJS_API_SECRET
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: CUBEJS_API_SECRET
- name: ADMIN_GOOGLE_OAUTH_CLIENT_SECRET
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: ADMIN_GOOGLE_OAUTH_CLIENT_SECRET
- name: APP_GOOGLE_OAUTH_CLIENT_SECRET
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: APP_GOOGLE_OAUTH_CLIENT_SECRET
- name: SEGMENT_BACKEND_WRITE_KEY
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: SEGMENT_BACKEND_WRITE_KEY
- name: SENDGRID_APIKEY
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: SENDGRID_APIKEY
- name: SINGER_IMPORTER_AUTH_TOKEN
  valueFrom:
    secretKeyRef:
      name: application-secrets
      key: SINGER_IMPORTER_AUTH_TOKEN
<% # This is some messed up shit that allows the rails application to create pods of itself. Because we use kubernetes-deploy to render out all these nice partials, the Rails app needs to be able to do the same, so we pass in the same data rendered out here as an environment variable that can then be decoded and reused in Rails. Sketchy. %>
<% if locals[:expose_contents_as_variable] %>
- name: RAILS_POD_TEMPLATE_YAML
  value: |
    rails_environment: <%= partial 'rails_environment', expose_contents_as_variable: false %>
    rails_volumes: <%= partial 'rails_volumes' %>
    rails_volume_mounts: <%= partial 'rails_volume_mounts' %>
<% end %>