SELECT AVG("warehouse"."dim_shopify_customers"."previous_3_month_revenue") AS a_1_roductlinefacts__customer_previous_3_month_revenue__average, "warehouse"."dim_shopify_variants"."product_type" AS sales__orderproductlinefacts__variant_product_type FROM "warehouse"."fct_shopify_order_product_lines" LEFT OUTER JOIN "warehouse"."dim_shopify_customers" ON "warehouse"."fct_shopify_order_product_lines"."customer_id" = "warehouse"."dim_shopify_customers"."customer_id" LEFT OUTER JOIN "warehouse"."dim_shopify_variants" ON "warehouse"."fct_shopify_order_product_lines"."variant_id" = "warehouse"."dim_shopify_variants"."variant_id" WHERE "warehouse"."fct_shopify_order_product_lines"."account_id" = 10 GROUP BY sales__orderproductlinefacts__variant_product_type ORDER BY a_1_roductlinefacts__customer_previous_3_month_revenue__average DESC LIMIT 5000